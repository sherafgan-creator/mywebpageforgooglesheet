<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Saved Records</title>

  <style>
    body {
      font-family: "Poppins", sans-serif;
      background: #f2f2f2;
      padding: 20px;
    }
    table {
      width: 100%;
      background: white;
      border-collapse: collapse;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    th, td {
      padding: 12px;
      border-bottom: 1px solid #ddd;
      text-align:left;
    }
    th {
      background: #6e8efb;
      color:white;
    }
    button {
      padding: 5px 10px;
      background:red;
      border:none;
      color:white;
      border-radius:5px;
      cursor:pointer;
    }
  </style>
</head>

<body>

<h2>Saved Student Data</h2>

<table id="dataTable">
  <thead>
    <tr>
      <th>#</th>
      <th>Name</th>
      <th>Roll</th>
      <th>Email</th>
      <th>Seat</th>
      <th>Delete</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const url = "https://script.google.com/macros/s/AKfycbxU0fDSDO4mtIwT1kvtqWCq29jc5R0TtJ7wU3vkZFix2pFeYSQqfIe8tyeTOczQjYCayg/exec?action=get"; 

// Load data automatically
loadData();

// Fetch data
function loadData() {
  fetch(scriptURL + "?action=get")
    .then(res => res.json())
    .then(data => buildTable(data));
}

// Build Table
function buildTable(data) {
  let tbody = document.querySelector("#dataTable tbody");
  tbody.innerHTML = "";

  data.forEach((item, i) => {
    let actualRow = i + 2; // Correct row number for Google Sheet

    let row = `
      <tr>
        <td>${i + 1}</td>
        <td>${item.name}</td>
        <td>${item.roll}</td>
        <td>${item.email}</td>
        <td>${item.seat}</td>
        <td>
          <button onclick="deleteRow(${actualRow})">Delete</button>
        </td>
      </tr>
    `;
    tbody.innerHTML += row;
  });
}

// Delete a row
function deleteRow(rowNumber) {
  if (!confirm("Delete this record?")) return;

  fetch(`${scriptURL}?action=delete&row=${rowNumber}`)
    .then(() => loadData());  // refresh table
}
</script>

</body>
</html>


<!--



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Saved Student Data</title>

  <style>
    body {
      font-family: Poppins, sans-serif;
      background: #eef1ff;
      margin: 0;
      padding: 20px;
    }

    h2 {
      text-align: center;
      color: #333;
      margin-bottom: 10px;
    }

    #searchBox {
      width: 95%;
      margin: 10px auto;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #aaa;
      display: block;
      font-size: 14px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 3px 15px rgba(0,0,0,0.1);
      margin-top: 10px;
    }

    th {
      background: #6e8efb;
      color: white;
      padding: 12px;
      font-size: 15px;
    }

    td {
      padding: 10px;
      border-bottom: 1px solid #eee;
      font-size: 14px;
      text-align: center;
    }

    tr:hover { background: #f3f5ff; }

    button.deleteBtn {
      background: #ff4b4b;
      border: none;
      color: white;
      padding: 6px 10px;
      border-radius: 6px;
      font-size: 12px;
      cursor: pointer;
    }

    #pagination {
      text-align: center;
      margin-top: 15px;
    }

    #pagination button {
      padding: 8px 15px;
      border: none;
      background: #556deb;
      color: white;
      margin: 5px;
      border-radius: 6px;
      cursor: pointer;
    }

    #download {
      display: block;
      width: 200px;
      margin: 15px auto;
      background: #1dbf73;
      color: white;
      padding: 10px;
      border-radius: 8px;
      text-align: center;
      text-decoration: none;
    }

    a.backBtn {
      display: block;
      width: 200px;
      margin: 10px auto;
      background: #556deb;
      color: white;
      padding: 10px;
      border-radius: 8px;
      text-align: center;
      text-decoration: none;
    }
  </style>
</head>

<body>

  <h2>ðŸ“„ Saved Student Data</h2>

  <input type="text" id="searchBox" placeholder="Search Name, Roll, Email...">

  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Name</th>
        <th>Roll</th>
        <th>Email</th>
        <th>Seat</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="dataBody"></tbody>
  </table>

  <div id="pagination">
    <button onclick="prevPage()">â¬… Previous</button>
    <button onclick="nextPage()">Next âž¡</button>
  </div>

  <a id="download" href="#">â¬‡ Download Excel (CSV)</a>
  <a class="backBtn" href="index.html">â¬… Back to Form</a>

  <script>
    const url = "https://script.google.com/macros/s/AKfycbxU0fDSDO4mtIwT1kvtqWCq29jc5R0TtJ7wU3vkZFix2pFeYSQqfIe8tyeTOczQjYCayg/exec?action=get"; 
    let allData = [];
    let currentPage = 1;
    const rowsPerPage = 10;

    function renderTable() {
      let output = "";
      let start = (currentPage - 1) * rowsPerPage;
      let end = start + rowsPerPage;
      let paginated = allData.slice(start, end);

      paginated.forEach((r, i) => {
        output += `
          <tr>
            <td>${r.date}</td>
            <td>${r.name}</td>
            <td>${r.roll}</td>
            <td>${r.email}</td>
            <td>${r.seat}</td>
            <td><button class="deleteBtn" onclick="deleteRow(${start + i + 2})">Delete</button></td>
          </tr>`;
      });

      document.getElementById("dataBody").innerHTML = output;
    }

    function nextPage() {
      if (currentPage * rowsPerPage < allData.length) {
        currentPage++;
        renderTable();
      }
    }

    function prevPage() {
      if (currentPage > 1) {
        currentPage--;
        renderTable();
      }
    }

    function searchFilter() {
      const q = document.getElementById("searchBox").value.toLowerCase();

      allData = allData.filter(r =>
        r.name.toLowerCase().includes(q) ||
        r.roll.toLowerCase().includes(q) ||
        r.email.toLowerCase().includes(q)
      );

      currentPage = 1;
      renderTable();
    }

    document.getElementById("searchBox").addEventListener("input", loadData);

    async function loadData() {
      try {
        const res = await fetch(url);
        allData = await res.json();
        renderTable();
      } catch (err) {
        console.error("Error fetching data");
      }
    }

    function downloadCSV() {
      let csv = "Date,Name,Roll,Email,Seat\n";
      allData.forEach(r => {
        csv += `${r.date},${r.name},${r.roll},${r.email},${r.seat}\n`;
      });

      const blob = new Blob([csv], { type: "text/csv" });
      const url = URL.createObjectURL(blob);
      document.getElementById("download").href = url;
      document.getElementById("download").download = "student_data.csv";
    }

    setInterval(loadData, 5000);

    loadData();
    downloadCSV();

    async function deleteRow(rowIndex) {
      if (!confirm("Delete this record?")) return;

      await fetch("YOUR_SCRIPT_WEBAPP_URL?action=delete&row=" + rowIndex);
      loadData();
    }
  </script>

</body>
</html>    -->
